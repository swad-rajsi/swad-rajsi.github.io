<!DOCTYPE html>
<html>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-95Q2G5RF8X"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-95Q2G5RF8X');
</script>
<script>
document.addEventListener('click', function(e) {
  const link = e.target.closest('a');
  if (!link) return;

  const href = link.getAttribute('href');
  if (!href) return;

  // Track internal recipe clicks
  if (href.startsWith('/recipes/')) {
    gtag('event', 'recipe_click', {
      event_category: 'engagement',
      event_label: href
    });
  }
});
</script>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ page.title }} | Recipes</title>
  <link rel="stylesheet" href="{{ '/assets/style.css' | relative_url }}">
</head>

<body>
  {% include navigation.html %}

  <main class="recipe" id="top">

    <div id="title-en" class="lang-block swad-rajsi-centre-display recipe-title">{{page.title}}</div>
    <div id="title-hi" class="lang-block swad-rajsi-centre-display recipe-title" style="display: none;">{{page.title_hi}}</div>
    
    {% if page.show_language_change_btn %}
    <div style="display:flex; justify-content:flex-end; margin-bottom:1em;">
      <button class="lang-btn active" onclick="setLang('en')">English</button>
      <button class="lang-btn" onclick="setLang('hi')">हिंदी</button>
    </div>
    {% endif %}

    <div style="display: flex;justify-content: center;align-items: center;">
      {% if page.image %}
      <img src="{{ page.image | relative_url }}" onerror="this.style.display='none'" class="recipe-img">
      {% endif %}
    </div>
    <div id="tableContent-en" class="lang-block" style="font-size: 1em;
    border-style: double;
    border-width: 1px;
    border-color: #417505;
    padding: 10px;
    background-color: rgb(238, 233, 233);
    max-width: 100%;border-radius: 4px;">
      <div style="padding: 10px;font-size: 20px;font-family:Georgia;color: #d25fd2ff;">Table of Contents</div>
      <div style="padding: 5px;"><a href="#Ingredients" style="text-decoration: none;"><span
            style="padding-right:10px;">1).</span><span>Ingredients</span></a></div>
      <div style="padding: 5px;"><a href="#steps-en" style="text-decoration: none;"><span
            style="padding-right:10px;">2).</span><span>Steps</span></a></div>
    </div>

    <div id="tableContent-hi" class="lang-block" style="display:none; font-size: 1em;
    border-style: double;
    border-width: 1px;
    border-color: #417505;
    padding: 10px;
    background-color: rgb(238, 233, 233);
    max-width: 100%;border-radius: 4px;">
      <div style="padding: 10px;font-size: 20px;font-family:Georgia;color: #d25fd2ff;">विषयसूची</div>
      <div style="padding: 5px;"><a href="#Ingredients" style="text-decoration: none;"><span
            style="padding-right:10px;">1).</span><span>सामग्री</span></a></div>
      <div style="padding: 5px;"><a href="#steps-hi" style="text-decoration: none;"><span
            style="padding-right:10px;">2).</span><span>खाना पकाने के चरण</span></a></div>
    </div>


    <div id="Ingredients" style="font-size: 1em;
    border-style: double;
    border-width: 1px;
    border-color: #417505;
    padding: 10px;
    background-color: bisque;
    max-width: 100%;margin-top: 20px;border-radius: 4px;">
      <div id="ingredients-en" class="lang-block" style="padding: 10px;font-size: 20px;font-family:Georgia;color: #d25fd2ff;">Ingredients</div>
      <div id="ingredients-hi" class="lang-block" style="display:none;padding: 10px;font-size: 20px;font-family:Georgia;color: #d25fd2ff;">सामग्री</div>
      <div style="padding:10px;max-width:100%;margin-bottom:20px;">
        <table style="border-style: dotted; 
    border-width: 2px;border-color:gray;font-size: 1em;max-width:100%;">
          <tr style="font-weight:bold;">
            <td class="swad-rajsi-td-border">Prep & Cook Time</td>
            <td class="swad-rajsi-td-border">Type</td>
            <td class="swad-rajsi-td-border" style="border-right: none !important;">Flavour</td>
          </tr>
          <tr>
            <td class="swad-rajsi-td-border" style="border-bottom: 2px dotted gray;">{{page.prep_time}} + {{page.cook_time}}</td>
            <td class="swad-rajsi-td-border" style="border-bottom: 2px dotted gray;">{{page.food_type}}</td>
            <td class="swad-rajsi-td-border" style="border-bottom: 2px dotted gray; border-right: none !important;">{{page.flavour}}</td>
          </tr>
          <tr style="font-weight:bold;">
            <td class="swad-rajsi-td-border">Course</td>
            <td class="swad-rajsi-td-border">Dietary Pattern</td>
            <td class="swad-rajsi-td-border" style="border-right: none !important;">Serving</td>
          </tr>
          <tr>
            <td class="swad-rajsi-td-border">{{page.course}}</td>
            <td class="swad-rajsi-td-border">{{page.dietary_pattern}}</td>
            <td class="swad-rajsi-td-border" style="border-right: none !important;">
              <div>
                <div class="serving-box">
                  <div id="servingValue" style="padding-right:10px;text-align: center;margin-bottom: 5px;">
                    {{page.serving}}</div>
                </div>
                <div class="serving-button-group">
                  <button class="serving-btn active" onclick="setValue(1, this)">1x</button>
                  <button class="serving-btn" onclick="setValue(2, this)">2x</button>
                  <button class="serving-btn" onclick="setValue(3, this)">3x</button>
                </div>
              </div>
            </td>
          </tr>
        </table>
      </div>
      <div id="ingredients-en" class="lang-block">
        {% assign ingredients = page.ingredients_en %}
        {% include recipe-ingredients.html ingredients=ingredients %}
      </div>
      <div id="ingredients-hi" class="lang-block" style="display:none">
        {% assign ingredients = page.ingredients_hi %}
        {% include recipe-ingredients.html ingredients=ingredients %}
      </div>
    </div>

    <div id="steps-en" class="lang-block"
      style="padding:10px;color: #d25fd2ff;font-size:20px;font-family:Georgia;justify-content:left !important;padding-bottom:5px;">
      Steps</div>
    <div id="steps-hi" class="lang-block" style="display:none;padding:10px;color: #d25fd2ff;font-size:20px;font-family:Georgia;justify-content:left !important;padding-bottom:5px;">
      खाना पकाने के चरण</div>
    <div id="steps-en" class="lang-block">
      {% assign steps = page.steps_en %}
      {% include recipe-steps.html steps=steps %}
    </div>
    <div id="steps-hi" class="lang-block" style="display:none">
      {% assign steps = page.steps_hi %}
      {% include recipe-steps.html steps=steps %}
    </div>

    <div id="desc-en" class="lang-block swad-rajsi-ingredients">{{ page.description_en }}</div>

    <div id="desc-hi" class="lang-block swad-rajsi-ingredients" style="display:none">{{ page.description_hi }}</div>


    <div style="display:flex;justify-content:right;gap:20px;padding-top: 2em;">
      <nav class="nav">
        <a class="swad-rajsi-nav recipe-page-bottom-anchor"
          href="#top">TOP</a>
        <a class="swad-rajsi-nav recipe-page-bottom-anchor"
          href="{{ '/contact/' | relative_url }}">CONTACT</a>
        <a class="swad-rajsi-nav recipe-page-bottom-anchor"
          href="{{ '/recipes/' | relative_url }}">RECIPES</a>
        <a class="swad-rajsi-nav recipe-page-bottom-anchor"
          href="{{ page.next.url | relative_url }}" title="{{ page.next.title }}">NEXT</a>
      </nav>
    </div>

  </main>

  {% include footer.html %}
</body>
<script>
  function setValue(value, element) {
    const baseServing = {{ page.serving_original }};
  // Update text
  document.getElementById("servingValue").innerText = value * baseServing;

  // Remove active class from all buttons
  document.querySelectorAll(".serving-btn").forEach(btn => {
    btn.classList.remove("active");
  });

  // Add active class to clicked button
  element.classList.add("active");
  document.querySelectorAll('.ingredient-item').forEach(item => {
    //console.log(item.dataset.qty + " " + item.dataset.unit + " " + item.dataset.name);
    if (item.dataset.qty !== undefined && item.dataset.qty !== '') {
      const scale = item.dataset.scale !== 'false';
      qty = item.dataset.qty.trim();
      var baseQty = Number(qty);
      if (qty.includes('/')) {
        const parts = qty.split('/');
        if (parts.length === 2) {
          const numerator = Number(parts[0]);
          const denominator = Number(parts[1]);
          if (!isNaN(numerator) && !isNaN(denominator) && denominator !== 0) {
            baseQty = numerator / denominator;
          }
        }
      }
      //console.log("Base Qty: " + baseQty + ", Scale: " + scale);
      // Skip if not scalable or not numeric
      if (!scale || isNaN(baseQty)) return;
      let newQty = baseQty * value;
      // Optional: round nicely
      //newQty = Number.isInteger(newQty) ? newQty : newQty.toFixed(1);
      item.querySelector('.qty').innerText = newQty;
    }
  });

  }
</script>
<script>
function setLang(lang) {
  document.querySelectorAll('.lang-block').forEach(el => {
    el.style.display = 'none';
  });

  document.querySelectorAll(`[id$="-${lang}"]`).forEach(el => {
    el.style.display = 'block';
  });

  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.classList.remove('active');
  });

  document.querySelector(`.lang-btn[onclick="setLang('${lang}')"]`)
    .classList.add('active');
}
</script>

</html>